window.gMap=function(){return{location:function(e,t,n){n=n?n:2e3,e.location=function(e){!this.Of&&this.Je?(!e&&this.i.Zc(this.Je),this.zq()):(this.sj&&this.Ce("startLocation"),!e&&this.$x())};var r=new BMap.Marker(point),i=new BMap.Size(58,63),s=t==="red"?new BMap.Icon("/img/flag.png",i,{imageOffset:new BMap.Size(-1,-169)}):new BMap.Icon("/img/flag.png",i,{imageOffset:new BMap.Size(-1,-105)});return r.setIcon(s),setInterval(function(){e.location(!0)},n),e.addEventListener("locationSuccess",function(e){map.addOverlay(r),r.setPosition(e.point),r.addEventListener("click",function(e){gMap.openPositonWindow(r.getPosition(),"你的位置：")})}),r},addBlueMarker:function(e,t){var n=new BMap.Marker(e),r=new BMap.Size(26,30),i=new BMap.Icon("/img/flag.png",r,{imageOffset:new BMap.Size(-1,-264)});if(t){var s=new BMap.Label(t);s.setStyle({border:"1px solid #2763f3"}),s.setOffset(0,0),n.setLabel(s)}return n.setIcon(i),n.enableDragging(),map.addOverlay(n),n.addEventListener("click",function(e){gMap.openPositonWindow(n.getPosition())}),n},addRedMarker:function(e,t){var n=new BMap.Marker(e),r=new BMap.Size(26,30),i=new BMap.Icon("/img/flag.png",r,{imageOffset:new BMap.Size(-1,-233)});if(t){var s=new BMap.Label(t);s.setStyle({border:"1px solid #f00"}),s.setOffset(0,0),n.setLabel(s)}return n.setIcon(i),map.addOverlay(n),n.addEventListener("click",function(e){gMap.openPositonWindow(n.getPosition(),"她的位置：")}),n},addSelfMarker:function(e,t){var n=new BMap.Marker(e),r=new BMap.Size(58,63),i=new BMap.Icon("/img/flag.png",r,{imageOffset:new BMap.Size(-1,-105)});if(t){var s=new BMap.Label(t);s.setStyle({border:"1px solid #000"}),s.setOffset(0,0),n.setLabel(s)}return n.setIcon(i),map.addOverlay(n),n.addEventListener("click",function(e){gMap.openPositonWindow(n.getPosition(),"你的位置：")}),n},addMissionMarker:function(e,t){var n=new BMap.Marker(e),r=new BMap.Size(54,60),i=new BMap.Icon("/img/flag.png",r,{imageOffset:new BMap.Size(-1,-295)});if(t){var s=new BMap.Label(t);s.setStyle({border:"1px solid #ff0"}),s.setOffset(0,0),n.setLabel(s)}return n.setIcon(i),map.addOverlay(n),n.addEventListener("click",function(e){gMap.openPositonWindow(n.getPosition(),"任务位置：")}),n},openPositonWindow:function(e,t,n){n=n?n:new BMap.Size(8,-18);var r=new BMap.Geocoder,i={title:t,offset:n},s=e.lng+" "+e.lat,o=new BMap.InfoWindow(s,i);r.getLocation(e,function(e){e&&(s=e.address,o.setContent(s))}),map.openInfoWindow(o,e)}}}()