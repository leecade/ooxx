var BMapLib=window.BMapLib=BMapLib||{};(function(){function n(e,t,n){return t!=null&&(e=Math.max(e,t)),n!=null&&(e=Math.min(e,n)),e}function r(e,t,n){while(e>n)e-=n-t;while(e<t)e+=n-t;return e}var e=6370996.81,t=BMapLib.GeoUtils=function(){};t.isPointInRect=function(e,t){if(e instanceof BMap.Point&&t instanceof BMap.Bounds){var n=t.getSouthWest(),r=t.getNorthEast();return e.lng>=n.lng&&e.lng<=r.lng&&e.lat>=n.lat&&e.lat<=r.lat}return!1},t.isPointInCircle=function(e,n){if(e instanceof BMap.Point&&n instanceof BMap.Circle){var r=n.getCenter(),i=n.getRadius(),s=t.getDistance(e,r);return s<=i?!0:!1}return!1},t.isPointOnPolyline=function(e,t){if(e instanceof BMap.Point&&t instanceof BMap.Polyline){var n=t.getBounds();if(!this.isPointInRect(e,n))return!1;var r=t.getPath();for(var i=0;i<r.length-1;i++){var s=r[i],o=r[i+1];if(e.lng>=Math.min(s.lng,o.lng)&&e.lng<=Math.max(s.lng,o.lng)&&e.lat>=Math.min(s.lat,o.lat)&&e.lat<=Math.max(s.lat,o.lat)){var u=(s.lng-e.lng)*(o.lat-e.lat)-(o.lng-e.lng)*(s.lat-e.lat);if(u<2e-10&&u>-2e-10)return!0}}return!1}return!1},t.isPointInPolygon=function(e,t){if(e instanceof BMap.Point&&t instanceof BMap.Polygon){var n=t.getBounds();if(!this.isPointInRect(e,n))return!1;var r=t.getPath(),i=r.length,s=!0,o=0,u=2e-10,a,f,l=e;a=r[0];for(var c=1;c<=i;++c){if(l.equals(a))return s;f=r[c%i];if(l.lat<Math.min(a.lat,f.lat)||l.lat>Math.max(a.lat,f.lat)){a=f;continue}if(l.lat>Math.min(a.lat,f.lat)&&l.lat<Math.max(a.lat,f.lat)){if(l.lng<=Math.max(a.lng,f.lng)){if(a.lat==f.lat&&l.lng>=Math.min(a.lng,f.lng))return s;if(a.lng==f.lng){if(a.lng==l.lng)return s;++o}else{var h=(l.lat-a.lat)*(f.lng-a.lng)/(f.lat-a.lat)+a.lng;if(Math.abs(l.lng-h)<u)return s;l.lng<h&&++o}}}else if(l.lat==f.lat&&l.lng<=f.lng){var p=r[(c+1)%i];l.lat>=Math.min(a.lat,p.lat)&&l.lat<=Math.max(a.lat,p.lat)?++o:o+=2}a=f}return o%2==0?!1:!0}return!1},t.degreeToRad=function(e){return Math.PI*e/180},t.radToDegree=function(e){return 180*e/Math.PI},t.getDistance=function(i,s){if(i instanceof BMap.Point&&s instanceof BMap.Point){i.lng=r(i.lng,-180,180),i.lat=n(i.lat,-74,74),s.lng=r(s.lng,-180,180),s.lat=n(s.lat,-74,74);var o,u,f,l;return o=t.degreeToRad(i.lng),f=t.degreeToRad(i.lat),u=t.degreeToRad(s.lng),l=t.degreeToRad(s.lat),e*Math.acos(Math.sin(f)*Math.sin(l)+Math.cos(f)*Math.cos(l)*Math.cos(u-o))}return 0},t.getPolylineDistance=function(e){if(e instanceof BMap.Polyline||e instanceof Array){var n;e instanceof BMap.Polyline?n=e.getPath():n=e;if(n.length<2)return 0;var r=0;for(var i=0;i<n.length-1;i++){var s=n[i],o=n[i+1],u=t.getDistance(s,o);r+=u}return r}return 0},t.getPolygonArea=function(t){if(t instanceof BMap.Polygon||t instanceof Array){var n;t instanceof BMap.Polygon?n=t.getPath():n=t;if(n.length<3)return 0;var r=0,i=0,s=0,o=0,u=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E=0,S=0,x=0,T=0,N=0,C=0,k=0,L=0,A=0,O=0,M=0,_=0,D=0,P=0,H=0,B=0,j=0,F=e,I=n.length;for(var q=0;q<I;q++)q==0?(i=n[I-1].lng*Math.PI/180,s=n[I-1].lat*Math.PI/180,o=n[0].lng*Math.PI/180,u=n[0].lat*Math.PI/180,f=n[1].lng*Math.PI/180,l=n[1].lat*Math.PI/180):q==I-1?(i=n[I-2].lng*Math.PI/180,s=n[I-2].lat*Math.PI/180,o=n[I-1].lng*Math.PI/180,u=n[I-1].lat*Math.PI/180,f=n[0].lng*Math.PI/180,l=n[0].lat*Math.PI/180):(i=n[q-1].lng*Math.PI/180,s=n[q-1].lat*Math.PI/180,o=n[q].lng*Math.PI/180,u=n[q].lat*Math.PI/180,f=n[q+1].lng*Math.PI/180,l=n[q+1].lat*Math.PI/180),c=Math.cos(u)*Math.cos(o),h=Math.cos(u)*Math.sin(o),p=Math.sin(u),d=Math.cos(s)*Math.cos(i),v=Math.cos(s)*Math.sin(i),m=Math.sin(s),g=Math.cos(l)*Math.cos(f),y=Math.cos(l)*Math.sin(f),b=Math.sin(l),w=(c*c+h*h+p*p)/(c*d+h*v+p*m),E=(c*c+h*h+p*p)/(c*g+h*y+p*b),S=w*d-c,x=w*v-h,T=w*m-p,N=E*g-c,C=E*y-h,k=E*b-p,_=(N*S+C*x+k*T)/(Math.sqrt(N*N+C*C+k*k)*Math.sqrt(S*S+x*x+T*T)),_=Math.acos(_),L=C*T-k*x,A=0-(N*T-k*S),O=N*x-C*S,c!=0?M=L/c:h!=0?M=A/h:M=O/p,M>0?(D+=_,B++):(P+=_,H++);var R,U;return R=D+(2*Math.PI*H-P),U=2*Math.PI*B-D+P,D>P?R-(I-2)*Math.PI<1?j=R:j=U:U-(I-2)*Math.PI<1?j=U:j=R,r=(j-(I-2)*Math.PI)*F*F,r}return 0}})()